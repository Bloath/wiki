# NFS根文件系统

> - 系统：ubuntu 16.04 x64
> - 嵌入式：NUC980 linux-4.4内核



[TOC]

## 一、下载安装NFS服务器

```
sudo apt install nfs-kernel-server -y  									
sudo /etc/init.d/nfs-kernel-server restart    	
sudo ufw disable    							
```

## 二、NFS文件夹配置

```
配置文件位置为 /etc/exports
写完后通过exportfs -r检查
通过showmount -e查看是否可挂载

/NFS_ROOT_NAME  (rw,sync,insecure,all_squash)

ro 该主机对该共享目录有只读权限
rw 该主机对该共享目录有读写权限
root_squash 客户机用root用户访问该共享文件夹时，将root用户映射成匿名用户
no_root_squash 客户机用root访问该共享文件夹时，不映射root用户
sync 资料同步写入到内存与硬盘中
async 资料会先暂存于内存中，而非直接写入硬盘
insecure 允许从这台机器过来的非授权访问

all_squash 客户机上的任何用户访问该共享目录时都映射成匿名用户
anonuid 将客户机上的用户映射成指定的本地用户ID的用户
anongid 将客户机上的用户映射成属于指定的本地用户组ID
```

## 三、arm-linux 内核配置

### 1. 打开网络相关选项

```
Networking support  --->
    Networking options  --->
        [*] TCP/IP networking
        [*]   IP: kernel level autoconfiguration
        [*]     IP: DHCP support
        [*]     IP: BOOTP support
        [*]     IP: RARP support
```

### 2. 打开NFS文件系统相关选项

```
File systems  --->
    [*] Network File Systems  --->
        <*>   NFS client support
        <*>     NFS client support for NFS version 2
        <*>     NFS client support for NFS version 3
        [*]   Root file system on NFS
```

### 3. 内核引导参数

```
root=/dev/nfs
nfsroot=s.s.s.s/path
ip=localAddress:serverAddress:gateway:netmask
```

## 